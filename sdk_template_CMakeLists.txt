cmake_minimum_required(VERSION 3.15)
project(MyMiyabiGame CXX C)

# --- Setup C++ Standard ---
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED TRUE)
set(CMAKE_CXX_EXTENSIONS OFF)
if(MSVC)
    add_compile_options(/Zc:__cplusplus)
endif()

# --- Define MIYABI SDK Paths ---
# Assumes the SDK is placed in a subdirectory named "miyabi_sdk"
set(MIYABI_SDK_PATH ${CMAKE_CURRENT_SOURCE_DIR}/miyabi_sdk)

# --- Add Your Game Executable ---
add_executable(my_game
    src/main.cpp
    # Add your other source files here
)

# --- Consume MIYABI SDK ---
target_include_directories(my_game PRIVATE ${MIYABI_SDK_PATH}/include)
target_link_directories(my_game PRIVATE ${MIYABI_SDK_PATH}/lib)

# Link order matters for static libraries:
# 1) logic exports get_miyabi_vtable()
# 2) runtime provides bridge callbacks used by logic
# 3) box2d is required by runtime
target_link_libraries(my_game PRIVATE
    miyabi_logic
    miyabi_logic_cxx
    miyabi_runtime
    box2d
)
